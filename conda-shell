#!/bin/sh

pause()
{
    local junk
    
    printf "Press return to continue..."
    read junk
}

if [ -e /usr/local/sbin/node-type ] && [ $(/usr/local/sbin/node-type) != compute ]; then
    printf "Error: $0 should only be run on compute nodes.\n"
    exit 1
fi

cat << EOM

Starting Linux bash shell to ensure that Conda packages are fully functional.

Note that uname will return Linux rather than $(uname) and some other aspects
of the environment will also indicate Linux.

Type "exit" or "Ctrl+d" to return to your $(uname) shell.

EOM

# Some tools (e.g. fastq-dump) will fail if they chose FreeBSD binaries over
# Linux, so put the Linux binaries explicitly first in PATH.  Otherwise,
# FreeBSD will only use tools rooted in /compat/linux if they are not found
# in /.
cl=/compat/linux
export PATH=$cl/bin:$cl/usr/bin:$cl/sbin:$cl/usr/sbin:$PATH
exec $cl/bin/bash
